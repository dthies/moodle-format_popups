define ("format_popups/book",["exports","core/config","core/fragment","core/notification","core/templates"],function(a,b,c,d,f){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.loadChapter=a.init=void 0;b=g(b);c=g(c);d=g(d);f=g(f);function g(a){return a&&a.__esModule?a:{default:a}}var h,i=function(a){var c=document.querySelector("#format_popups_activity_content");h=a;c.removeEventListener("click",j);c.addEventListener("click",j);c.querySelectorAll("a").forEach(function(a){var c=a.getAttribute("href");if(c&&0===c.search("view.php")){a.setAttribute("href",b.default.wwwroot+"/mod/book/"+c)}});if(c.querySelector("#book_toc")&&!document.querySelector("#toggletoc")){f.default.render("format_popups/booktoc",[]).then(f.default.prependNodeContents.bind(f.default,c.closest(".modal-content").querySelector(".modal-title"))).fail(d.default.exception)}};a.init=i;var j=function(a){var b=a.target.closest("a.bookprev, a.booknext, .book_toc a");if(a.target.closest("a.bookexit")){a.preventDefault()}if(b){var e=b.getAttribute("data-chapterid")||new URLSearchParams(b.getAttribute("href")).get("chapterid"),g=new URLSearchParams({chapterid:e});if(!e){return}a.preventDefault();a.stopPropagation();c.default.loadFragment("format_popups","mod",h,{jsondata:JSON.stringify(g.toString()),modname:"book"}).then(f.default.replaceNodeContents.bind(f.default,"#format_popups_activity_content")).fail(d.default.exception)}};a.loadChapter=j});
//# sourceMappingURL=book.min.js.map
