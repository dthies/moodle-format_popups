define ("format_popups/book",["exports","core/config","core/fragment","core/notification","core/templates"],function(a,b,c,d,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.loadChapter=a.init=void 0;b=f(b);c=f(c);d=f(d);e=f(e);function f(a){return a&&a.__esModule?a:{default:a}}var g,h=function(a){var c=document.querySelector("#format_popups_activity_content");g=a;c.removeEventListener("click",i);c.addEventListener("click",i);c.querySelectorAll("a").forEach(function(a){var c=a.getAttribute("href");if(c&&0===c.search("view.php")){a.setAttribute("href",b.default.wwwroot+"/mod/book/"+c)}});if(c.querySelector("#book_toc")&&!document.querySelector("#toggletoc")){e.default.render("format_popups/booktoc",[]).then(e.default.prependNodeContents.bind(e.default,c.closest(".modal-content").querySelector(".modal-title"))).fail(d.default.exception)}};a.init=h;var i=function(a){var b=a.target.closest("a.bookprev, a.booknext, .book_toc a");if(a.target.closest("a.bookexit")){a.preventDefault()}if(b){var f=b.getAttribute("data-chapterid")||new URLSearchParams(b.getAttribute("href")).get("chapterid"),h=new URLSearchParams({chapterid:f});if(!f){return}a.preventDefault();a.stopPropagation();c.default.loadFragment("format_popups","mod",g,{jsondata:JSON.stringify(h.toString()),modname:"book"}).then(function(a,b){e.default.replaceNodeContents("#format_popups_activity_content",a,b)}).fail(d.default.exception)}};a.loadChapter=i});
//# sourceMappingURL=book.min.js.map
