define("format_popups/book",["exports","core/config","core/fragment","core/notification","core/templates"],(function(_exports,_config,_fragment,_notification,_templates){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Module to add navigation to book modal
   *
   * @module     format_popups/book
   * @copyright  2021 Daniel Thies <dethies@gmail.com>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */var contextid;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.loadChapter=_exports.init=void 0,_config=_interopRequireDefault(_config),_fragment=_interopRequireDefault(_fragment),_notification=_interopRequireDefault(_notification),_templates=_interopRequireDefault(_templates);_exports.init=id=>{let content=document.querySelector("#format_popups_activity_content");contextid=id,content.removeEventListener("click",loadChapter),content.addEventListener("click",loadChapter),content.querySelectorAll("a").forEach((function(anchor){let href=anchor.getAttribute("href");href&&0===href.search("view.php")&&anchor.setAttribute("href",_config.default.wwwroot+"/mod/book/"+href)})),content.querySelector("#book_toc")&&!document.querySelector("#toggletoc")&&content.closest(".modal-content").querySelectorAll(".modal-title").forEach((async function(header){try{const node=await _templates.default.render("format_popups/booktoc",[]);_templates.default.prependNodeContents(header,node,"")}catch(e){_notification.default.exception(e)}}))};const loadChapter=e=>{const anchor=e.target.closest("a.bookprev, a.booknext, .book_toc a");if(e.target.closest("a.bookexit")&&e.preventDefault(),anchor){const chapterid=anchor.getAttribute("data-chapterid"),params=new URLSearchParams({chapterid:chapterid});if(!chapterid)return;e.preventDefault(),e.stopPropagation();try{_templates.default.replaceNodeContents("#format_popups_activity_content",_fragment.default.loadFragment("format_popups","mod",contextid,{jsondata:JSON.stringify(params.toString()),modname:"book"}))}catch(e){_notification.default.exception(e)}}};_exports.loadChapter=loadChapter}));

//# sourceMappingURL=book.min.js.map