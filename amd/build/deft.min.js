define("format_popups/deft",["exports","core/ajax","core/utils","core/log","core/notification","format_popups/popups","block_deft/socket"],(function(_exports,_ajax,_utils,_log,_notification,_popups,_socket){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Add Deft response bleck to update course page remotely
   *
   * @module     format_popups/deft
   * @copyright  2023 Daniel Thies <dethies@gmail.com>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_ajax=_interopRequireDefault(_ajax),_log=_interopRequireDefault(_log),_notification=_interopRequireDefault(_notification),_popups=_interopRequireDefault(_popups),_socket=_interopRequireDefault(_socket);_exports.init=(contextid,courseid,displaysection,token,throttle)=>{const socket=new Socket(contextid,token);_popups.default.init(contextid,courseid,displaysection,"format_popups"),socket.subscribe((0,_utils.debounce)(_popups.default.updatePage.bind(_popups.default),throttle))};class Socket extends _socket.default{renewToken(contextid){_ajax.default.call([{methodname:"format_popups_renew_token",args:{contextid:contextid},done:replacement=>{_log.default.debug("Reconnecting"),this.connect(contextid,replacement.token)},fail:_notification.default.exception}])}}}));

//# sourceMappingURL=deft.min.js.map