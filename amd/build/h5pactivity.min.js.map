{"version":3,"file":"h5pactivity.min.js","sources":["../src/h5pactivity.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Module to show h5pactivity report in modal\n *\n * @module     format_popups/h5pactivity\n * @copyright  2021 Daniel Thies <dethies@gmail.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport config from 'core/config';\nimport Fragment from 'core/fragment';\nimport notification from 'core/notification';\nimport templates from 'core/templates';\n\nvar contextid, modname, instance;\n/**\n * Initialize Choice mod actions\n *\n * @param {int} id Course module context id\n * @param {string} name Activity type\n * @param {int} instanceid H5P activity instance id\n */\nexport const init = (id, name, instanceid) => {\n    'use strict';\n    contextid = id;\n    modname = name;\n    instance = instanceid;\n\n    document.querySelector('#format_popups_activity_content').removeEventListener('click', showReport);\n    document.querySelector('#format_popups_activity_content').addEventListener('click', showReport);\n};\n\n/**\n * Show report page\n *\n * @param {object} e Event\n */\nconst showReport = async(e) => {\n    let anchor = e.target.closest('a');\n    if (anchor) {\n        let url = new URL(anchor.getAttribute('href')),\n            params = url.searchParams;\n\n        if (url.origin + url.pathname === config.wwwroot + '/mod/h5pactivity/report.php' && params.get('a') === instance) {\n            e.preventDefault();\n            e.stopPropagation();\n            try {\n                templates.replaceNodeContents('#format_popups_activity_content', await Fragment.loadFragment(\n                    'format_popups',\n                    'mod',\n                    contextid,\n                    {\n                        jsondata: JSON.stringify(params.toString()),\n                        modname: modname\n                    }\n                ));\n            } catch (e) {\n                notification.exception(e);\n            }\n        }\n    }\n};\n"],"names":["contextid","modname","instance","id","name","instanceid","document","querySelector","removeEventListener","showReport","addEventListener","async","anchor","e","target","closest","url","URL","getAttribute","params","searchParams","origin","pathname","config","wwwroot","get","preventDefault","stopPropagation","replaceNodeContents","Fragment","loadFragment","jsondata","JSON","stringify","toString","exception"],"mappings":";;;;;;;SA2BIA,UAAWC,QAASC,0RAQJ,CAACC,GAAIC,KAAMC,cAE3BL,UAAYG,GACZF,QAAUG,KACVF,SAAWG,WAEXC,SAASC,cAAc,mCAAmCC,oBAAoB,QAASC,YACvFH,SAASC,cAAc,mCAAmCG,iBAAiB,QAASD,mBAQlFA,WAAaE,MAAAA,QACXC,OAASC,EAAEC,OAAOC,QAAQ,QAC1BH,OAAQ,KACJI,IAAM,IAAIC,IAAIL,OAAOM,aAAa,SAClCC,OAASH,IAAII,gBAEbJ,IAAIK,OAASL,IAAIM,WAAaC,gBAAOC,QAAU,+BAAiCL,OAAOM,IAAI,OAASvB,SAAU,CAC9GW,EAAEa,iBACFb,EAAEc,yCAEYC,oBAAoB,wCAAyCC,kBAASC,aAC5E,gBACA,MACA9B,UACA,CACI+B,SAAUC,KAAKC,UAAUd,OAAOe,YAChCjC,QAASA,WAGnB,MAAOY,yBACQsB,UAAUtB"}