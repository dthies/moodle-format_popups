define("format_popups/folder",["exports","core/config","core/notification","core/templates"],(function(_exports,_config,_notification,_templates){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Module to display files in a folder in modal
   *
   * @module     format_popups/folder
   * @copyright  2021 Daniel Thies <dethies@gmail.com>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */var cmid,contextid;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_config=_interopRequireDefault(_config),_notification=_interopRequireDefault(_notification),_templates=_interopRequireDefault(_templates);_exports.init=(context,cm)=>{contextid=context,cmid=cm,document.querySelector("#format_popups_activity_content").removeEventListener("click",embedFiles),document.querySelector("#format_popups_activity_content").addEventListener("click",embedFiles)};const embedFiles=e=>{let anchor=e.target.closest("div.foldertree a");if(anchor){let url=new URL(anchor.getAttribute("href")),returnurl=new URL(_config.default.wwwroot+"/mod/folder/view.php"),path=url.pathname.split("/").slice(-5);if(!url.searchParams.get("forcedownload")&&path[0]==contextid){let isimage=-1!==path[4].search(".")&&["gif","jpg","jpeg","png","svg"].includes(path[4].split(".").pop());e.preventDefault(),e.stopPropagation(),returnurl.searchParams.append("id",cmid),_templates.default.render("format_popups/embedfile",{heading:decodeURI(path[4]),image:isimage,returnurl:returnurl.toString(),url:url.toString(),params:[{name:"forcedownload",value:1}]}).then(_templates.default.replaceNodeContents.bind(_templates.default,"#format_popups_activity_content")).fail(_notification.default.exception)}}}}));

//# sourceMappingURL=folder.min.js.map